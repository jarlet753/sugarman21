<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Party Games">
    <title>Party Games - Impostor</title>
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==">
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==">
    <meta name="theme-color" content="#f85032">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            margin: 0;
            padding: 0;
            overscroll-behavior: none;
            touch-action: manipulation;
        }
        
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: opacity 0.3s ease;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            touch-action: pan-y;
        }
        
        .hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Background Gradients */
        .home-bg {
            background: #000000;
        }
        
        .impostor-bg {
            background: linear-gradient(135deg, #f85032 0%, #e73827 50%, #ff6b35 100%);
        }


        
        /* Settings Icon - Clean Apple UI Style */
        .settings-icon {
            position: fixed;
            top: clamp(50px, 10vw, 70px);
            right: clamp(20px, 5vw, 30px);
            background: rgba(255,255,255,0.15);
            border: none;
            border-radius: 22px;
            color: white;
            font-size: clamp(20px, 5vw, 24px);
            width: clamp(56px, 14vw, 64px);
            height: clamp(56px, 14vw, 64px);
            cursor: pointer;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .settings-icon:active {
            transform: scale(0.92);
            background: rgba(255,255,255,0.25);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        /* Clean Settings Symbol */
        .settings-icon::before {
            content: '';
            width: 24px;
            height: 24px;
            background: currentColor;
            mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z'/%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 12a3 3 0 11-6 0 3 3 0 016 0z'/%3E%3C/svg%3E") no-repeat center;
            mask-size: contain;
            -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z'/%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 12a3 3 0 11-6 0 3 3 0 016 0z'/%3E%3C/svg%3E") no-repeat center;
            -webkit-mask-size: contain;
        }
        
        /* Modern Settings Menu - DARK */
        .settings-menu {
            position: fixed;
            top: clamp(110px, 20vw, 140px);
            right: clamp(20px, 5vw, 30px);
            background: rgba(0,0,0,0.95);
            border-radius: 24px;
            padding: 8px;
            min-width: 220px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            z-index: 999;
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: none;
        }
        
        .settings-menu.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
            pointer-events: auto;
        }
        
        .settings-menu-item {
            padding: 16px 20px;
            color: white;
            cursor: pointer;
            border-radius: 16px;
            margin-bottom: 4px;
            font-size: clamp(15px, 3.5vw, 17px);
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .settings-menu-item:hover, .settings-menu-item:active {
            background: rgba(255,255,255,0.1);
            transform: scale(0.98);
        }
        
        .settings-menu-item:last-child {
            margin-bottom: 0;
        }
        
        /* Header Container - WENIGER ABSTAND */
        .header-container {
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            width: 100%;
            height: clamp(80px, 15vh, 100px); /* VIEL KLEINER */
            margin-bottom: 10px; /* WENIGER MARGIN */
            margin-top: 30px; /* WENIGER MARGIN */
        }
        
        /* Typography - GRÖßERE HEADLINE */
        .title {
            font-size: clamp(38px, 11vw, 64px); /* GRÖßER */
            font-weight: 800;
            color: white;
            text-align: center;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
            line-height: 1;
            z-index: 2;
            position: relative;
        }
        
        .title-suffix {
            font-size: clamp(16px, 4.5vw, 26px); /* GRÖßER */
            color: rgba(255,255,255,0.6);
            font-weight: 400;
            margin-left: 8px;
        }
        
        /* Controller Emoji - GRÖßER */
        .controller-emoji {
            font-size: clamp(35px, 9vw, 60px); /* GRÖßER */
            position: absolute;
            left: clamp(-5px, 2vw, 15px);
            top: clamp(-20px, -4vw, -12px); /* MEHR OFFSET */
            transform: rotate(-15deg);
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
            opacity: 0.85;
            z-index: 3;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { 
                transform: rotate(-15deg) translateY(0px); 
            }
            50% { 
                transform: rotate(-15deg) translateY(-8px); 
            }
        }
        
        /* Game Cards Container - FIXED */
        .games-container {
            display: flex;
            gap: 20px;
            width: 100%;
            max-width: 100vw;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
            padding: 0 20px;
            margin-bottom: 20px; /* MEHR ABSTAND ZU PUNKTEN */
        }
        
        .games-container::-webkit-scrollbar {
            display: none;
        }
        
        /* WIRKLICH SMOOTH TRANSITION */
        .screen-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000000;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s cubic-bezier(0.25, 0.1, 0.25, 1); /* ULTRA SMOOTH */
        }

        .screen-transition.active {
            opacity: 1;
            pointer-events: auto;
        }

        .screen-transition.impostor {
            background: linear-gradient(135deg, #f85032 0%, #e73827 50%, #ff6b35 100%);
        }

        /* DARK MODE KONSEQUENT UMGESETZT */
        body {
            background: #000000;
            color: white;
        }

        /* CLEAN DARK THEME FÜR ALLE SETTINGS - RICHTIG UMGESETZT */
        
        /* IMPOSTOR SETTINGS SCREEN - CLEAN DARK */
        .settings-container {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.15);
        }

        .setting-label {
            color: white;
        }

        .counter-btn {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .counter-value {
            color: white;
        }

        .toggle-switch {
            background: rgba(255,255,255,0.25);
        }

        .dropdown-button {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .dropdown-menu {
            background: rgba(0,0,0,0.95);
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .dropdown-item {
            color: white;
        }

        .dropdown-item:hover, .dropdown-item:active {
            background: rgba(255,255,255,0.1);
        }

        /* GAME SCREEN - CLEAN DARK */
        .player-title {
            color: white;
        }

        .reveal-button {
            color: white;
        }

        /* GAME STARTED SCREEN - CLEAN DARK */
        .goal-box {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.15);
        }

        .goal-title {
            color: white;
        }

        .goal-item {
            color: white;
        }

        .starter-text {
            color: white;
        }

        /* ROLES SCREEN - CLEAN DARK */
        .role-item {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.15);
            color: white;
        }

        .role-player {
            color: white;
        }

        .role-result {
            color: white;
        }

        .timer-display {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        /* MODAL - CLEAN DARK */
        .modal {
            background: rgba(0,0,0,0.95);
            color: white;
            border: 2px solid rgba(255,255,255,0.15);
        }

        .modal-close {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .modal-close:hover, .modal-close:active {
            background: rgba(255,255,255,0.2);
        }

        .modal-title {
            color: white;
        }

        /* STATS - CLEAN DARK */
        .stat-item {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .stat-value {
            color: white;
        }

        .stat-label {
            color: rgba(255,255,255,0.8);
        }

        /* HISTORY & ACHIEVEMENTS - CLEAN DARK */
        .history-item, 
        .achievement-item {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.12);
            color: white;
        }

        .achievement-item.unlocked {
            background: rgba(76, 175, 80, 0.2);
            border-color: rgba(76, 175, 80, 0.4);
        }
        body.light-theme {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }

        body.light-theme .home-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body.light-theme .title {
            color: white;
        }

        body.light-theme .settings-icon {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        body.light-theme .settings-menu {
            background: rgba(255,255,255,0.95);
            color: #333;
            border: 1px solid rgba(255,255,255,0.4);
        }

        body.light-theme .settings-menu-item {
            color: #333;
        }

        body.light-theme .modal {
            background: rgba(255,255,255,0.95);
            color: #333;
        }

        body.light-theme .modal-close {
            color: #666;
        }

        body.light-theme .modal-title {
            color: #333;
        }

        body.light-theme .game-card {
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        body.light-theme .snap-dot {
            background: rgba(255,255,255,0.4);
        }

        body.light-theme .snap-dot.active {
            background: white;
        }

        body.light-theme .back-button {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        /* SETTINGS SCREEN LIGHT THEME */
        body.light-theme .settings-container {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.15);
        }

        body.light-theme .setting-label {
            color: white;
        }

        body.light-theme .counter-btn {
            background: rgba(255,255,255,0.25);
            color: white;
        }

        body.light-theme .counter-value {
            color: white;
        }

        body.light-theme .toggle-switch {
            background: rgba(255,255,255,0.3);
        }

        body.light-theme .dropdown-button {
            background: rgba(255,255,255,0.25);
            color: white;
        }

        body.light-theme .dropdown-menu {
            background: rgba(255,255,255,0.95);
            color: #333;
        }

        body.light-theme .dropdown-item {
            color: #333;
        }

        /* PLAYER CARD LIGHT THEME */
        body.light-theme .player-card {
            box-shadow: 0 16px 40px rgba(0,0,0,0.15);
        }

        body.light-theme .player-title {
            color: white;
        }

        body.light-theme .reveal-button {
            color: white;
        }

        /* GAME STARTED SCREEN LIGHT THEME */
        body.light-theme .goal-box {
            background: rgba(255,255,255,0.25);
            border: 1px solid rgba(255,255,255,0.15);
        }

        body.light-theme .goal-title {
            color: white;
        }

        body.light-theme .goal-item {
            color: white;
        }

        body.light-theme .starter-text {
            color: white;
        }

        /* ROLES SCREEN LIGHT THEME */
        body.light-theme .role-item {
            background: rgba(255,255,255,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
        }

        body.light-theme .role-player {
            color: white;
        }

        body.light-theme .role-result {
            color: white;
        }

        body.light-theme .timer-display {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        /* MODAL CONTENT LIGHT THEME */
        body.light-theme .history-item, 
        body.light-theme .achievement-item {
            background: rgba(0,0,0,0.05);
            border: 2px solid rgba(0,0,0,0.08);
        }
        
        /* GAME CARDS REDESIGNED - BESSERE GRÖßE */
        .game-card {
            min-width: calc(100vw - 60px);
            max-width: calc(100vw - 60px);
            height: clamp(360px, 55vh, 450px); /* KLEINER GEMACHT */
            border-radius: 32px;
            padding: 28px; /* WENIGER PADDING */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            scroll-snap-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .game-card:active {
            transform: scale(0.96);
        }
        
        .impostor-card {
            background: linear-gradient(135deg, rgba(248, 80, 50, 0.9) 0%, rgba(231, 56, 39, 0.9) 100%);
            color: white;
            border: 2px solid rgba(255,255,255,0.2);
        }
        
        .impostor-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(0,0,0,0.1) 100%);
            pointer-events: none;
            border-radius: 32px;
        }
        
        .coming-soon-card {
            background: linear-gradient(135deg, rgba(100, 100, 100, 0.8) 0%, rgba(150, 150, 150, 0.8) 100%);
            color: white;
            opacity: 0.7;
            cursor: not-allowed;
            border: 2px solid rgba(255,255,255,0.1);
        }
        
        .game-card-emoji {
            font-size: clamp(60px, 15vw, 75px); /* KLEINER */
            margin-bottom: 20px;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.3));
            background: rgba(255,255,255,0.15);
            width: clamp(100px, 22vw, 120px); /* KLEINER */
            height: clamp(100px, 22vw, 120px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .game-card-title {
            font-size: clamp(20px, 5vw, 25px); /* KLEINER */
            font-weight: 700;
            margin-bottom: 14px;
            text-align: center;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            letter-spacing: -0.5px;
            line-height: 1.1; /* FÜR MEHRZEILIGE TITEL */
        }
        
        .game-card-desc {
            font-size: clamp(14px, 3.5vw, 17px); /* KLEINER */
            text-align: center;
            opacity: 0.9;
            margin-bottom: 24px;
            line-height: 1.5;
            font-weight: 400;
        }
        
        .game-card-players {
            background: rgba(0,0,0,0.25);
            border-radius: 20px; /* KLEINER */
            padding: 10px 16px; /* KLEINER */
            font-size: clamp(12px, 3vw, 14px);
            font-weight: 600;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        /* Snap Indicators - Wie ursprünglich */
        .snap-indicators {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            justify-content: center;
        }
        
        .snap-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255,255,255,0.4);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            cursor: pointer;
        }
        
        .snap-dot.active {
            background: white;
            transform: scale(1.3);
            box-shadow: 0 4px 12px rgba(255,255,255,0.4);
        }
        
        .snap-dot:hover {
            background: rgba(255,255,255,0.7);
            transform: scale(1.1);
        }

        /* MODAL - DARK THEME ÜBERSCHREIBT ALLES */
        .modal {
            background: rgba(0,0,0,0.95) !important;
            color: white !important;
            border: 2px solid rgba(255,255,255,0.15) !important;
        }

        .modal-close {
            background: rgba(255,255,255,0.1) !important;
            color: white !important;
        }

        .modal-close:hover, .modal-close:active {
            background: rgba(255,255,255,0.2) !important;
        }

        .modal-title {
            color: white !important;
        }

        /* STATS - DARK THEME ÜBERSCHREIBT */
        .stat-item {
            background: rgba(255,255,255,0.1) !important;
            color: white !important;
        }

        .stat-value {
            color: white !important;
        }

        .stat-label {
            color: rgba(255,255,255,0.8) !important;
        }

        /* HISTORY & ACHIEVEMENTS - DARK THEME ÜBERSCHREIBT */
        .history-item, 
        .achievement-item {
            background: rgba(255,255,255,0.08) !important;
            border: 2px solid rgba(255,255,255,0.12) !important;
            color: white !important;
        }

        .achievement-item.unlocked {
            background: rgba(76, 175, 80, 0.2) !important;
            border-color: rgba(76, 175, 80, 0.4) !important;
        }
        .credits {
            position: fixed;
            bottom: clamp(15px, 4vw, 25px);
            left: 0;
            right: 0;
            font-size: clamp(11px, 2.8vw, 13px);
            color: rgba(255,255,255,0.6);
            text-align: center;
            z-index: 10;
            font-weight: 500;
        }
        
        /* Back Button */
        .back-button {
            position: absolute;
            top: clamp(20px, 5vw, 30px);
            left: clamp(20px, 5vw, 30px);
            background: rgba(0,0,0,0.3);
            border: none;
            border-radius: 20px;
            color: white;
            font-size: clamp(18px, 4.5vw, 22px);
            width: clamp(48px, 12vw, 56px);
            height: clamp(48px, 12vw, 56px);
            cursor: pointer;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .back-button:active {
            transform: scale(0.9);
            background: rgba(0,0,0,0.5);
        }
        
        /* Settings Container */
        .settings-container {
            background: rgba(0,0,0,0.2);
            border-radius: 28px;
            padding: clamp(28px, 6vw, 36px);
            margin: 20px 0;
            width: 100%;
            max-width: min(440px, 90vw);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 16px 40px rgba(0,0,0,0.1);
        }
        
        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: clamp(20px, 5vw, 28px) 0;
            color: white;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .setting-label {
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 600;
            display: flex;
            align-items: center;
            flex: 1;
            min-width: 140px;
        }
        
        .setting-icon {
            font-size: clamp(22px, 5.5vw, 26px);
            margin-right: 16px;
            width: 32px;
            text-align: center;
        }
        
        /* Counter Controls */
        .counter-controls {
            display: flex;
            align-items: center;
            gap: clamp(14px, 3.5vw, 20px);
        }
        
        .counter-btn {
            width: clamp(42px, 10vw, 48px);
            height: clamp(42px, 10vw, 48px);
            border-radius: 50%;
            background: rgba(255,255,255,0.25);
            border: none;
            color: white;
            font-size: clamp(20px, 5vw, 24px);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .counter-btn:active {
            transform: scale(0.9);
            background: rgba(255,255,255,0.4);
        }
        
        .counter-value {
            font-size: clamp(18px, 4.5vw, 22px);
            font-weight: 700;
            min-width: clamp(32px, 8vw, 38px);
            text-align: center;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            width: clamp(56px, 14vw, 62px);
            height: clamp(32px, 8vw, 36px);
            background: rgba(255,255,255,0.3);
            border-radius: 18px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .toggle-switch.active {
            background: #4CAF50;
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: clamp(28px, 7vw, 32px);
            height: clamp(28px, 7vw, 32px);
            border-radius: 50%;
            background: white;
            top: 50%;
            left: 2px;
            transform: translateY(-50%);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .toggle-switch.active::after {
            left: calc(100% - clamp(28px, 7vw, 32px) - 2px);
        }
        
        /* Dropdown */
        .dropdown {
            position: relative;
        }
        
        .dropdown-button {
            background: rgba(255,255,255,0.25);
            border: none;
            border-radius: 18px;
            color: white;
            padding: clamp(10px, 2.5vw, 12px) clamp(18px, 4.5vw, 20px);
            font-size: clamp(14px, 3.5vw, 16px);
            font-weight: 500;
            cursor: pointer;
            min-width: clamp(90px, 22vw, 100px);
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .dropdown-button:active {
            background: rgba(255,255,255,0.4);
            transform: scale(0.98);
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(255,255,255,0.95);
            border-radius: 16px;
            margin-top: 8px;
            min-width: 140px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 16px 40px rgba(0,0,0,0.15);
            z-index: 100;
            overflow: hidden;
        }
        
        .dropdown-item {
            padding: clamp(12px, 3vw, 14px) clamp(18px, 4.5vw, 20px);
            color: #333;
            cursor: pointer;
            font-size: clamp(14px, 3.5vw, 16px);
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .dropdown-item:hover, .dropdown-item:active {
            background: rgba(0,0,0,0.08);
        }
        
        /* Buttons - OHNE KONTUR */
        .button {
            background: rgba(0,0,0,0.3);
            border: none;
            border-radius: 24px;
            color: white;
            font-size: clamp(16px, 4.2vw, 20px);
            font-weight: 700;
            padding: clamp(18px, 4.5vw, 24px) clamp(32px, 8vw, 42px);
            margin: 10px;
            min-width: clamp(240px, 65vw, 320px);
            max-width: 90vw;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            text-decoration: none;
            display: block;
            outline: none;
            -webkit-appearance: none;
            user-select: none;
            -webkit-user-select: none;
            position: relative;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            z-index: 100;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        
        .button:active, .button:hover {
            transform: scale(0.96);
            background: rgba(0,0,0,0.5);
            box-shadow: 0 12px 32px rgba(0,0,0,0.15);
        }
        
        /* Player Card */
        .player-card {
            background: linear-gradient(135deg, #ffb347 0%, #ff8c42 100%);
            border-radius: 28px;
            padding: clamp(28px, 7vw, 36px);
            margin: 20px 0;
            width: 100%;
            max-width: min(400px, 90vw);
            text-align: center;
            box-shadow: 0 16px 40px rgba(0,0,0,0.2);
            border: 3px solid rgba(255,255,255,0.3);
            transition: all 0.4s ease;
            position: relative;
        }
        
        .player-card.flipping {
            animation: cardFlip 0.6s ease-in-out;
        }
        
        @keyframes cardFlip {
            0% { transform: rotateY(0deg) scale(1); }
            50% { transform: rotateY(90deg) scale(0.95); }
            100% { transform: rotateY(0deg) scale(1); }
        }
        
        .player-card.lifted {
            transform: translateY(-20px);
            box-shadow: 0 28px 60px rgba(0,0,0,0.3);
        }
        
        .player-title {
            font-size: clamp(24px, 6vw, 32px);
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .player-emoji {
            font-size: clamp(56px, 14vw, 72px);
            margin: 20px 0;
            background: rgba(255,255,255,0.3);
            width: clamp(80px, 20vw, 100px);
            height: clamp(80px, 20vw, 100px);
            border-radius: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            backdrop-filter: blur(10px);
        }
        
        .reveal-button {
            background: rgba(255,255,255,0.25);
            border-radius: 20px;
            color: white;
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 600;
            padding: clamp(16px, 4vw, 20px) clamp(20px, 5vw, 24px);
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
            backdrop-filter: blur(10px);
        }
        
        .reveal-button:active {
            transform: scale(0.96);
            background: rgba(255,255,255,0.35);
        }
        
        /* Revealed Content */
        .revealed-content {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.9);
            border-radius: 28px;
            padding: clamp(20px, 5vw, 24px);
            margin-top: 12px;
            text-align: center;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 40;
            pointer-events: none;
            backdrop-filter: blur(20px);
        }
        
        .revealed-content.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .role-icon {
            width: clamp(52px, 13vw, 60px);
            height: clamp(52px, 13vw, 60px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: clamp(22px, 6vw, 28px);
            font-weight: bold;
            color: white;
        }
        
        .role-icon.impostor {
            background: #f44336;
        }
        
        .role-icon.normal {
            background: #4CAF50;
        }
        
        .role-text {
            font-size: clamp(18px, 4.5vw, 22px);
            font-weight: 600;
            color: white;
            margin-bottom: 16px;
        }
        
        .word-display {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: clamp(16px, 4vw, 20px);
            font-size: clamp(24px, 6vw, 28px);
            font-weight: 700;
            color: #333;
            backdrop-filter: blur(10px);
        }
        
        .hint-display {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: clamp(12px, 3vw, 14px);
            font-size: clamp(14px, 3.5vw, 16px);
            color: #666;
            backdrop-filter: blur(10px);
        }
        
        /* Timer Display */
        .timer-display {
            position: absolute;
            top: clamp(20px, 5vw, 30px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.3);
            border-radius: 24px;
            padding: clamp(12px, 3vw, 14px) clamp(20px, 5vw, 24px);
            color: white;
            font-size: clamp(18px, 4.5vw, 22px);
            font-weight: 700;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
        }
        
        /* Starter Text */
        .starter-text {
            font-size: clamp(28px, 7vw, 36px);
            font-weight: 700;
            color: white;
            text-align: center;
            margin: 28px 0;
            animation: pulse 2s infinite;
            transition: font-size 1s ease;
        }
        
        .starter-text.shrunk {
            font-size: clamp(20px, 5vw, 24px);
            animation: none;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
        
        /* Goal Box */
        .goal-box {
            background: rgba(0,0,0,0.25);
            border-radius: 24px;
            padding: clamp(20px, 5vw, 24px);
            margin: 20px 0;
            width: 100%;
            max-width: min(400px, 90vw);
            text-align: left;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.15);
        }
        
        .goal-title {
            font-size: clamp(22px, 5.5vw, 26px);
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .goal-item {
            margin-bottom: 16px;
            color: white;
            line-height: 1.5;
            font-size: clamp(16px, 4vw, 18px);
        }
        
        .goal-emoji {
            font-size: clamp(22px, 5.5vw, 26px);
            margin-right: 14px;
        }
        
        /* Roles List */
        .roles-list {
            width: 100%;
            max-width: min(440px, 90vw);
            margin: 20px 0;
            max-height: 65vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .role-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: clamp(16px, 4vw, 20px);
            margin: 12px 0;
            color: white;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .role-player {
            display: flex;
            align-items: center;
            font-size: clamp(16px, 4vw, 18px);
            font-weight: 600;
            flex: 1;
        }
        
        .role-result {
            font-size: clamp(14px, 3.5vw, 16px);
            text-align: right;
            margin-left: 14px;
        }
        
        /* Confetti Animation */
        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10000;
        }
        
        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f39c12;
            animation: confetti-fall 3s linear infinite;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* KOMPLETT NEUES MODAL DESIGN */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .modal-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }
        
        .modal {
            background: rgba(255,255,255,0.95);
            border-radius: 32px;
            padding: 32px;
            width: 92%;
            max-width: 480px;
            max-height: 85vh;
            overflow-y: auto;
            color: #333;
            position: relative;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 32px 80px rgba(0,0,0,0.25);
            transform: scale(0.9) translateY(20px);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .modal-overlay.visible .modal {
            transform: scale(1) translateY(0);
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 24px;
            background: rgba(0,0,0,0.1);
            border: none;
            color: #666;
            font-size: 28px;
            cursor: pointer;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover, .modal-close:active {
            background: rgba(0,0,0,0.15);
            transform: scale(0.9);
        }
        
        .modal-title {
            font-size: clamp(26px, 6.5vw, 34px);
            font-weight: 700;
            margin-bottom: 24px;
            text-align: center;
            color: #333;
        }
        
        /* STATS GRID - ÜBERARBEITET */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .stat-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            color: white;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: clamp(28px, 7vw, 36px);
            font-weight: 800;
            color: white;
        }
        
        .stat-label {
            font-size: clamp(12px, 3vw, 14px);
            opacity: 0.9;
            margin-top: 8px;
            font-weight: 500;
        }
        
        /* SHARE BUTTON */
        .share-button {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            border: none;
            border-radius: 16px;
            color: white;
            font-size: clamp(14px, 3.5vw, 16px);
            font-weight: 600;
            padding: 12px 20px;
            margin-top: 16px;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .share-button:active {
            transform: scale(0.98);
            background: linear-gradient(135deg, #45a049 0%, #4CAF50 100%);
        }
        
        /* HISTORY UND ACHIEVEMENT ITEMS REDESIGN */
        .history-item, .achievement-item {
            background: rgba(0,0,0,0.05);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .history-item:active, .achievement-item:active {
            transform: scale(0.98);
            background: rgba(0,0,0,0.08);
        }
        
        .achievement-item.unlocked {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.15) 0%, rgba(56, 142, 60, 0.15) 100%);
            border-color: rgba(76, 175, 80, 0.3);
        }
        
        .achievement-icon {
            font-size: 28px;
            margin-right: 16px;
        }
        
        /* Small Screen Optimizations */
        @media screen and (max-height: 600px) {
            .screen {
                padding: 16px;
                justify-content: flex-start;
                padding-top: 28px;
            }
            
            .title {
                font-size: clamp(28px, 7vw, 40px);
                margin-bottom: 16px;
            }
            
            .settings-container, .player-card, .goal-box {
                margin: 14px 0;
                padding: 20px;
            }
        }
        
        @media screen and (max-width: 320px) {
            .setting-row {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            
            .counter-controls {
                justify-content: center;
            }
            
            .button {
                min-width: 90%;
                margin: 10px auto;
            }
            
            .games-container {
                gap: 16px;
                padding: 0 16px;
            }
            
            .game-card {
                min-width: calc(100vw - 40px);
                max-width: calc(100vw - 40px);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Landscape Orientation */
        @media screen and (orientation: landscape) and (max-height: 500px) {
            .screen {
                flex-direction: row;
                flex-wrap: wrap;
                align-content: center;
                justify-content: center;
                padding: 14px;
            }
            
            .title {
                font-size: 30px;
                margin: 10px 0;
                width: 100%;
            }
            
            .settings-container, .player-card {
                max-width: 340px;
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Settings Icon - Apple Style -->
    <button class="settings-icon" id="settingsIcon" onclick="toggleSettingsMenu()"></button>
    
    <!-- Settings Menu -->
    <div class="settings-menu" id="settingsMenu">
        <div class="settings-menu-item" onclick="showStatsModal()">
            📊 Statistiken
        </div>
        <div class="settings-menu-item" onclick="showHistoryModal()">
            📚 Spiel-Historie
        </div>
        <div class="settings-menu-item" onclick="showAchievementsModal()">
            🏆 Erfolge
        </div>
        <div class="settings-menu-item" onclick="showInstallModal()">
            📱 App installieren
        </div>
        <div class="settings-menu-item" onclick="toggleTheme()">
            🌙 Theme: <span id="themeStatus">Dark</span>
        </div>
        <div class="settings-menu-item" onclick="toggleSounds()">
            🔊 Sounds: <span id="soundStatus">An</span>
        </div>
        <div class="settings-menu-item" onclick="toggleVibration()">
            📳 Vibration: <span id="vibrationStatus">An</span>
        </div>
        <div class="settings-menu-item" style="opacity: 0.6; cursor: default; border-top: 1px solid rgba(0,0,0,0.1); margin-top: 8px; padding-top: 16px;">
            💻 made by C at School
        </div>
    </div>

    <!-- Clean Screen Transition -->
    <div class="screen-transition" id="screenTransition"></div>

    <!-- Mode Select Screen -->
    <div id="modeSelectScreen" class="screen home-bg">
        <div class="header-container">
            <h1 class="title">Party-games<span class="title-suffix">.me</span></h1>
            <div class="controller-emoji">🎮</div>
        </div>
        
        <div class="games-container" id="gamesContainer">
            <div class="game-card impostor-card" onclick="showImpostorSettings()">
                <div class="game-card-emoji">🎭</div>
                <div class="game-card-title">FINDET DEN<br>IMPOSTOR</div>
                <div class="game-card-desc">Finde heraus, wer der Verräter in eurer Gruppe ist!</div>
                <div class="game-card-players">👥 3-20</div>
            </div>
            
            <div class="game-card coming-soon-card">
                <div class="game-card-emoji">🎯</div>
                <div class="game-card-title">MEHR SPIELE</div>
                <div class="game-card-desc">Weitere Party-Spiele kommen bald!</div>
                <div class="game-card-players">Bald verfügbar</div>
            </div>
        </div>
        
        <!-- Snap Indicators -->
        <div class="snap-indicators">
            <div class="snap-dot active" id="dot1" onclick="scrollToCard(0)"></div>
            <div class="snap-dot" id="dot2" onclick="scrollToCard(1)"></div>
        </div>
    </div>

    <!-- Impostor Settings Screen -->
    <div id="impostorScreen" class="screen impostor-bg hidden">
        <button class="back-button" onclick="showModeSelect()">←</button>
        
        <h1 class="title" style="font-size: clamp(28px, 7vw, 36px); margin-bottom: 28px;">Impostor</h1>
        
        <div class="settings-container">
            <div class="setting-row">
                <div class="setting-label">
                    <span class="setting-icon">👥</span>
                    Spieler
                </div>
                <div class="counter-controls">
                    <button class="counter-btn" onclick="changePlayerCount(-1)">−</button>
                    <span class="counter-value" id="playersCount">4</span>
                    <button class="counter-btn" onclick="changePlayerCount(1)">+</button>
                </div>
            </div>
            
            <div class="setting-row">
                <div class="setting-label">
                    <span class="setting-icon">🎭</span>
                    Impostor
                </div>
                <div class="counter-controls">
                    <button class="counter-btn" onclick="changeImpostorCount(-1)">−</button>
                    <span class="counter-value" id="impostorsCount">1</span>
                    <button class="counter-btn" onclick="changeImpostorCount(1)">+</button>
                </div>
            </div>
            
            <div class="setting-row">
                <div class="setting-label">
                    <span class="setting-icon">⏱️</span>
                    Zeitlimit
                </div>
                <div class="toggle-switch" id="timerToggle" onclick="toggleTimer()"></div>
            </div>
            
            <div class="setting-row" id="timerMinutesRow" style="display: none;">
                <div class="setting-label">
                    <span class="setting-icon">🕐</span>
                    Minuten
                </div>
                <div class="counter-controls">
                    <button class="counter-btn" onclick="changeTimerMinutes(-1)">−</button>
                    <span class="counter-value" id="timerMinutesCount">2</span>
                    <button class="counter-btn" onclick="changeTimerMinutes(1)">+</button>
                </div>
            </div>
            
            <div class="setting-row">
                <div class="setting-label">
                    <span class="setting-icon">🏷️</span>
                    Kategorien
                </div>
                <div class="dropdown">
                    <button class="dropdown-button" id="categoryButton" onclick="toggleCategoryDropdown()">Alle ▼</button>
                    <div class="dropdown-menu hidden" id="categoryDropdown">
                        <div class="dropdown-item" onclick="selectCategory('alle')">Alle</div>
                        <div class="dropdown-item" onclick="selectCategory('food')">Essen</div>
                        <div class="dropdown-item" onclick="selectCategory('animals')">Tiere</div>
                        <div class="dropdown-item" onclick="selectCategory('objects')">Objekte</div>
                    </div>
                </div>
            </div>
            
            <div class="setting-row">
                <div class="setting-label">
                    <span class="setting-icon">💡</span>
                    Hinweise für Impostor
                </div>
                <div class="toggle-switch active" id="hintsToggle" onclick="toggleHints()"></div>
            </div>
        </div>
        
        <button class="button" onclick="startGame()">
            Spiel starten
        </button>
    </div>

    <!-- Game Playing Screen -->
    <div id="gameScreen" class="screen impostor-bg hidden">
        <button class="back-button" onclick="showImpostorSettings()">←</button>
        
        <h2 style="color: white; font-size: clamp(18px, 4.5vw, 24px); margin-bottom: 28px; font-weight: 600;">Impostor</h2>
        
        <div class="player-card" id="playerCard">
            <div class="player-title" id="playerTitle">Spieler 1</div>
            <div class="player-emoji" id="playerEmoji">👤</div>
            <button class="reveal-button" 
                    onmousedown="showRole()" onmouseup="hideRole()" onmouseleave="hideRole()"
                    ontouchstart="showRole()" ontouchend="hideRole()">
                <div style="margin-bottom: 8px;">↑</div>
                Karte aufdecken
            </button>
            
            <div class="revealed-content" id="revealedContent">
                <div class="role-icon" id="roleIcon">✓</div>
                <div class="role-text" id="roleText">Du bist Impostor!</div>
                <div id="wordOrHint"></div>
            </div>
        </div>
        
        <div style="height: 140px;"></div> <!-- SPACER -->
        
        <button class="button" onclick="handleNextPlayer()" id="nextButton">
            Weitergeben
        </button>
        
        <p style="color: rgba(255,255,255,0.8); font-size: clamp(14px, 3.5vw, 16px); text-align: center; margin-top: 14px;">
            Gerät an den nächsten Spieler weitergeben
        </p>
    </div>

    <!-- Game Started Screen -->
    <div id="gameStartedScreen" class="screen impostor-bg hidden">
        <button class="back-button" onclick="showImpostorSettings()">←</button>
        
        <div id="timerDisplay" class="timer-display hidden">5:00</div>
        
        <div style="text-align: center;">
            <div style="font-size: clamp(80px, 20vw, 100px); margin-bottom: 28px;">🎭</div>
            <h1 class="title" style="font-size: clamp(32px, 8vw, 40px); margin-bottom: 20px;">Spiel läuft!</h1>
            <div class="starter-text" id="starterText">Spieler 1 beginnt</div>
        </div>
        
        <div class="goal-box">
            <div class="goal-title">Ziel:</div>
            <div class="goal-item">
                <span class="goal-emoji">👥</span>
                <strong>Normale Spieler:</strong><br>Findet den Impostor!
            </div>
            <div class="goal-item">
                <span class="goal-emoji">🎭</span>
                <strong>Impostor:</strong><br>Erratet das Wort!
            </div>
        </div>
        
        <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 14px; margin-top: 28px;">
            <button class="button" onclick="showRoles()">
                Rollen aufdecken
            </button>
            <button class="button" onclick="showImpostorSettings()">
                Neues Spiel
            </button>
        </div>
    </div>

    <!-- End Screen -->
    <div id="endScreen" class="screen impostor-bg hidden">
        <button class="back-button" onclick="showGameStarted()">←</button>
        
        <h1 class="title" style="font-size: clamp(24px, 6vw, 32px); margin-bottom: 28px;">Rollen aufdecken</h1>
        
        <div class="roles-list" id="rolesList">
            <!-- Dynamically populated -->
        </div>
        
        <button class="button" onclick="showImpostorSettings()">
            Neues Spiel
        </button>
    </div>

    <!-- Modal Overlay -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal" id="modalContent">
            <button class="modal-close" onclick="closeModal()">×</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Confetti Container -->
    <div class="confetti" id="confetti"></div>

    <script>
        // Game State
        let gameState = {
            totalPlayers: 4,
            impostors: 1,
            timerEnabled: false,
            timerMinutes: 2,
            hintsEnabled: true,
            category: 'alle',
            currentPlayer: 1,
            gameWord: '',
            gameHint: '',
            impostorPlayers: [],
            playerEmojis: [],
            startingPlayer: 1,
            timer: null,
            timeLeft: 0,
            gameStartTime: null,
            roundDuration: 0
        };

        // Settings
        let settings = {
            soundsEnabled: true,
            vibrationEnabled: true,
            lightTheme: false
        };

        // Stats and Achievements - OHNE GEWINNER/VERLIERER
        let playerStats = {
            gamesPlayed: 0,
            totalImpostorRounds: 0,
            fastestGame: null,
            longestGame: null,
            totalPlayTime: 0
        };
        
        let gameHistory = [];
        let achievements = {};

        // Word categories
        const WORD_CATEGORIES = {
            food: [
                { word: "Sushi", hint: "japanisch" },
                { word: "Croissant", hint: "französisch" },
                { word: "Tacos", hint: "mexikanisch" },
                { word: "Pasta", hint: "al dente" },
                { word: "Curry", hint: "scharf" },
                { word: "Döner", hint: "türkisch" },
                { word: "Ramen", hint: "Nudeln" },
                { word: "Burger", hint: "amerikanisch" },
                { word: "Spaghetti", hint: "lang" },
                { word: "Popcorn", hint: "knallt" },
                { word: "Wasabi", hint: "brennt" },
                { word: "Mozzarella", hint: "cremig" },
                { word: "Pizza", hint: "italienisch" },
                { word: "Bratwurst", hint: "deutsch" },
                { word: "Kimchi", hint: "koreanisch" },
                { word: "Bolognese", hint: "Soße" }
            ],
            
            animals: [
                { word: "Flamingo", hint: "rosa" },
                { word: "Pinguin", hint: "watschelt" },
                { word: "Koala", hint: "australisch" },
                { word: "Giraffe", hint: "Hals" },
                { word: "Delfin", hint: "intelligent" },
                { word: "Faultier", hint: "langsam" },
                { word: "Chamäleon", hint: "wechselt" },
                { word: "Känguru", hint: "hüpft" },
                { word: "Oktopus", hint: "acht" },
                { word: "Seepferdchen", hint: "maritim" },
                { word: "Erdmännchen", hint: "wacht" },
                { word: "Alpaka", hint: "flauschig" },
                { word: "Elefant", hint: "Rüssel" },
                { word: "Tiger", hint: "gestreift" },
                { word: "Eule", hint: "nachts" }
            ],
            
            objects: [
                { word: "Regenschirm", hint: "schützt" },
                { word: "AirPods", hint: "Musik" },
                { word: "Skateboard", hint: "rollt" },
                { word: "Fernbedienung", hint: "TV" },
                { word: "Sonnenbrille", hint: "cool" },
                { word: "Rucksack", hint: "trägt" },
                { word: "Wasserflasche", hint: "Durst" },
                { word: "Powerbank", hint: "strom" },
                { word: "Latte", hint: "Heiß" },
                { word: "Bluetooth-Box", hint: "drahtlos" },
                { word: "Smartwatch", hint: "Handgelenk" },
                { word: "Gaming-Stuhl", hint: "zocken" },
                { word: "Kamera", hint: "Aufnahme" },
                { word: "Schreibtisch", hint: "arbeiten" },
                { word: "Kühlschrank", hint: "abkühlen" },
                { word: "Hoodie", hint: "Kapuze" },
                { word: "Bob Marley", hint: "Jamaika" },
                { word: "Herausforderung", hint: "Anstrengend" },
                { word: "Laptop", hint: "aufklappen" },
                { word: "Monitor", hint: "Bild" },
                { word: "Paket", hint: "pappe" },
                { word: "DHL", hint: "Bestellen" },
                { word: "Cappie", hint: "Kopfbedeckung" },
                { word: "Links", hint: "seite" },
                { word: "Rechts", hint: "politisch" },
                { word: "Spotify", hint: "Playlist" },
                { word: "LED", hint: "leuchtet" },
                { word: "Filter", hint: "verschönt" },
                { word: "Zoomen", hint: "näher" },
                { word: "Snackautomat", hint: "klemmt" },
                { word: "Influencer", hint: "Story" },
                { word: "Escape Room", hint: "Rätsel" },
                { word: "Timer", hint: "tick" },
                { word: "Spiegel", hint: "selber" },
                { word: "U8", hint: "vercraked" },
                { word: "1%", hint: "wenig" }
            ]
        };

        const coolEmojis = ['😎', '🤩', '🔥', '⚡', '🎯', '💀', '💎', '👾', '🪼', '🎊', '🎉', '🦄', '🐉', '👑', '🏆'];

        // Achievement definitions - OHNE GEWINNER
        const ACHIEVEMENTS = {
            firstGame: { name: "Erstes Spiel", description: "Spiele dein erstes Spiel", icon: "🎮" },
            veteran: { name: "Veteran", description: "Spiele 25 Spiele", icon: "🏅" },
            impostor: { name: "Der Verräter", description: "Sei 10 Mal Impostor", icon: "🎭" },
            speedRunner: { name: "Speedrunner", description: "Spiele unter 30 Sekunden", icon: "⚡" },
            marathon: { name: "Marathon", description: "Spiele über 10 Minuten", icon: "🏃" },
            social: { name: "Gesellig", description: "Spiele mit 10+ Personen", icon: "👥" },
            dedicated: { name: "Hingabe", description: "Spiele 100 Spiele", icon: "💯" },
            explorer: { name: "Entdecker", description: "Spiele alle Kategorien", icon: "🗺️" }
        };

        // Audio Context for Sound Effects
        let audioContext;
        
        // Sound Effects
        function playSound(type) {
            if (!settings.soundsEnabled) return;
            
            try {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                switch(type) {
                    case 'card-flip':
                        oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(400, audioContext.currentTime + 0.1);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.1);
                        break;
                        
                    case 'success':
                        oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1);
                        oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        oscillator.start(audioContext.currentTime);
                        oscillator.stop(audioContext.currentTime + 0.3);
                        break;
                        
                    case 'shuffle':
                        for(let i = 0; i < 3; i++) {
                            const osc = audioContext.createOscillator();
                            const gain = audioContext.createGain();
                            osc.connect(gain);
                            gain.connect(audioContext.destination);
                            osc.frequency.setValueAtTime(300 + i * 100, audioContext.currentTime + i * 0.05);
                            gain.gain.setValueAtTime(0.05, audioContext.currentTime + i * 0.05);
                            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i * 0.05 + 0.1);
                            osc.start(audioContext.currentTime + i * 0.05);
                            osc.stop(audioContext.currentTime + i * 0.05 + 0.1);
                        }
                        break;
                }
            } catch(e) {
                console.log('Audio not supported');
            }
        }

        // Haptic Feedback
        function vibrate(pattern) {
            if (settings.vibrationEnabled && 'vibrate' in navigator) {
                navigator.vibrate(pattern || [100]);
            }
        }

        // Confetti Effect
        function showConfetti() {
            const confettiContainer = document.getElementById('confetti');
            const colors = ['#f39c12', '#e74c3c', '#9b59b6', '#3498db', '#2ecc71', '#f1c40f'];
            
            for (let i = 0; i < 50; i++) {
                const confettiPiece = document.createElement('div');
                confettiPiece.className = 'confetti-piece';
                confettiPiece.style.left = Math.random() * 100 + '%';
                confettiPiece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confettiPiece.style.animationDelay = Math.random() * 3 + 's';
                confettiPiece.style.animationDuration = (Math.random() * 2 + 2) + 's';
                confettiContainer.appendChild(confettiPiece);
                
                setTimeout(() => {
                    if (confettiPiece.parentNode) {
                        confettiPiece.remove();
                    }
                }, 5000);
            }
        }

        // Settings Menu Functions
        function toggleSettingsMenu() {
            const menu = document.getElementById('settingsMenu');
            menu.classList.toggle('visible');
            updateSettingsDisplay();
        }

        function updateSettingsDisplay() {
            const soundStatus = document.getElementById('soundStatus');
            const vibrationStatus = document.getElementById('vibrationStatus');
            const themeStatus = document.getElementById('themeStatus');
            if (soundStatus) soundStatus.textContent = settings.soundsEnabled ? 'An' : 'Aus';
            if (vibrationStatus) vibrationStatus.textContent = settings.vibrationEnabled ? 'An' : 'Aus';
            if (themeStatus) themeStatus.textContent = settings.lightTheme ? 'Light' : 'Dark';
        }

        function showInstallModal() {
            toggleSettingsMenu();
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            const isAndroid = /Android/.test(navigator.userAgent);
            
            let content = `
                <div style="text-align: center; margin-bottom: 24px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">📱</div>
                    <p style="color: #666; font-size: 16px; line-height: 1.5;">
                        Installiere Party Games als App auf deinem Gerät für die beste Erfahrung!
                    </p>
                </div>
            `;
            
            if (isIOS) {
                content += `
                    <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; margin-bottom: 16px;">
                        <h3 style="margin-bottom: 16px; color: #333;">📱 iOS Installation:</h3>
                        <ol style="color: #666; line-height: 1.6; padding-left: 20px;">
                            <li>Tippe auf das <strong>Teilen-Symbol</strong> 📤 in Safari</li>
                            <li>Scrolle nach unten und wähle <strong>"Zum Home-Bildschirm"</strong></li>
                            <li>Tippe auf <strong>"Hinzufügen"</strong> in der oberen rechten Ecke</li>
                            <li>Die App erscheint jetzt auf deinem Home-Bildschirm! 🎉</li>
                        </ol>
                    </div>
                `;
            } else if (isAndroid) {
                content += `
                    <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; margin-bottom: 16px;">
                        <h3 style="margin-bottom: 16px; color: #333;">🤖 Android Installation:</h3>
                        <ol style="color: #666; line-height: 1.6; padding-left: 20px;">
                            <li>Tippe auf das <strong>Menü-Symbol</strong> ⋮ in Chrome</li>
                            <li>Wähle <strong>"App installieren"</strong> oder <strong>"Zum Startbildschirm hinzufügen"</strong></li>
                            <li>Bestätige mit <strong>"Installieren"</strong></li>
                            <li>Die App ist jetzt in deinen Apps verfügbar! 🎉</li>
                        </ol>
                    </div>
                `;
            } else {
                content += `
                    <div style="background: #f8f9fa; border-radius: 16px; padding: 20px; margin-bottom: 16px;">
                        <h3 style="margin-bottom: 16px; color: #333;">💻 Desktop Installation:</h3>
                        <ol style="color: #666; line-height: 1.6; padding-left: 20px;">
                            <li>Klicke auf das <strong>Install-Symbol</strong> in der Adressleiste</li>
                            <li>Oder: Menü → <strong>"Party Games installieren"</strong></li>
                            <li>Bestätige die Installation</li>
                            <li>Die App ist jetzt als eigenständige App verfügbar! 🎉</li>
                        </ol>
                    </div>
                `;
            }
            
            content += `
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px; padding: 16px; color: white; text-align: center;">
                    <strong>✨ Vorteile der App:</strong><br>
                    🚀 Schnellerer Start • 📱 Vollbild-Modus • 🔔 Keine Browser-Leiste
                </div>
            `;
            
            showModal('📱 App installieren', content);
        }

        function toggleSounds() {
            settings.soundsEnabled = !settings.soundsEnabled;
            updateSettingsDisplay();
            playSound('card-flip');
            toggleSettingsMenu();
        }

        function toggleVibration() {
            settings.vibrationEnabled = !settings.vibrationEnabled;
            updateSettingsDisplay();
            vibrate([50]);
            toggleSettingsMenu();
        }

        // Modal Functions
        function showModal(title, content) {
            const modalBody = document.getElementById('modalBody');
            if (modalBody) {
                modalBody.innerHTML = `<h2 class="modal-title">${title}</h2>${content}`;
                document.getElementById('modalOverlay').classList.add('visible');
            }
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('visible');
        }

        function toggleTheme() {
            settings.lightTheme = !settings.lightTheme;
            document.body.classList.toggle('light-theme', settings.lightTheme);
            updateSettingsDisplay();
            playSound('card-flip');
            toggleSettingsMenu();
        }

        function showStatsModal() {
            toggleSettingsMenu();
            const totalGames = playerStats.gamesPlayed;
            const averageGameTime = playerStats.totalPlayTime > 0 ? 
                Math.round(playerStats.totalPlayTime / playerStats.gamesPlayed) + 's' : 'N/A';
            const favCategory = getFavoriteCategory();
            const playedCategories = getPlayedCategories();
            
            const content = `
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">${totalGames}</div>
                        <div class="stat-label">Spiele gespielt</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${playerStats.totalImpostorRounds}</div>
                        <div class="stat-label">Mal Impostor</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${playerStats.fastestGame || 'N/A'}</div>
                        <div class="stat-label">Schnellstes Spiel</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${playerStats.longestGame || 'N/A'}</div>
                        <div class="stat-label">Längstes Spiel</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${averageGameTime}</div>
                        <div class="stat-label">⌀ Spielzeit</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${playedCategories}</div>
                        <div class="stat-label">Kategorien gespielt</div>
                    </div>
                </div>
                <button class="share-button" onclick="shareStats()">
                    📊 Stats teilen
                </button>
            `;
            showModal('📊 Deine Statistiken', content);
        }

        function getPlayedCategories() {
            if (gameHistory.length === 0) return '0/4';
            
            const categories = new Set();
            gameHistory.forEach(game => {
                const word = game.word.toLowerCase();
                
                const foodWords = ['sushi', 'pizza', 'pasta', 'burger', 'curry', 'döner', 'ramen', 'croissant', 'tacos', 'popcorn', 'wasabi', 'mozzarella', 'bratwurst', 'kimchi', 'bolognese'];
                const animalWords = ['flamingo', 'pinguin', 'koala', 'giraffe', 'delfin', 'tiger', 'elefant', 'faultier', 'chamäleon', 'känguru', 'oktopus', 'seepferdchen', 'erdmännchen', 'alpaka', 'eule'];
                
                if (foodWords.some(f => word.includes(f.toLowerCase()))) {
                    categories.add('Essen');
                } else if (animalWords.some(a => word.includes(a.toLowerCase()))) {
                    categories.add('Tiere');
                } else {
                    categories.add('Objekte');
                }
            });
            
            return `${categories.size}/3`;
        }

        function getFavoriteCategory() {
            if (gameHistory.length === 0) return 'N/A';
            
            const categoryCounts = {};
            gameHistory.forEach(game => {
                // Simple category detection based on word
                const word = game.word.toLowerCase();
                let category = 'Objekte';
                
                const foodWords = ['sushi', 'pizza', 'pasta', 'burger', 'curry', 'döner', 'ramen'];
                const animalWords = ['flamingo', 'pinguin', 'koala', 'giraffe', 'delfin', 'tiger', 'elefant'];
                
                if (foodWords.some(f => word.includes(f))) category = 'Essen';
                else if (animalWords.some(a => word.includes(a))) category = 'Tiere';
                
                categoryCounts[category] = (categoryCounts[category] || 0) + 1;
            });
            
            return Object.keys(categoryCounts).reduce((a, b) => 
                categoryCounts[a] > categoryCounts[b] ? a : b
            );
        }

        function shareStats() {
            const totalGames = playerStats.gamesPlayed;
            const impostorGames = playerStats.totalImpostorRounds;
            const unlockedAchievements = Object.keys(achievements).filter(key => achievements[key]).length;
            const playedCategories = getPlayedCategories();
            
            const shareText = `🎭 Meine Impostor Stats:\n\n` +
                `🎮 ${totalGames} Spiele gespielt\n` +
                `🎭 ${impostorGames}x Impostor gewesen\n` +
                `⚡ Schnellstes Spiel: ${playerStats.fastestGame || 'N/A'}\n` +
                `🕐 Längstes Spiel: ${playerStats.longestGame || 'N/A'}\n` +
                `🎯 Kategorien: ${playedCategories}\n` +
                `🏆 ${unlockedAchievements} Erfolge freigeschaltet\n\n` +
                `Spiele auch mit: party-games.me 🎯`;

            if (navigator.share) {
                navigator.share({
                    title: 'Meine Impostor Stats',
                    text: shareText
                }).catch(err => {
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }

        function showHistoryModal() {
            toggleSettingsMenu();
            const recentGames = gameHistory.slice(-10).reverse();
            let content = '<div style="max-height: 300px; overflow-y: auto;">';
            
            if (recentGames.length === 0) {
                content += '<p style="text-align: center; opacity: 0.7; font-size: 16px; padding: 40px 0;">Noch keine Spiele gespielt</p>';
            } else {
                recentGames.forEach((game) => {
                    const date = new Date(game.date).toLocaleDateString('de-DE');
                    const timeOfDay = new Date(game.date).toLocaleTimeString('de-DE', {hour: '2-digit', minute: '2-digit'});
                    
                    content += `
                        <div class="history-item">
                            <div>
                                <strong style="font-size: 16px;">${game.word}</strong><br>
                                <small style="color: #666; font-size: 13px;">${date} ${timeOfDay} • ${game.players} Spieler • ${game.duration}</small>
                            </div>
                            <div style="font-size: 24px;">🎭</div>
                        </div>
                    `;
                });
            }
            
            content += '</div>';
            content += `<button class="share-button" onclick="shareHistory()">📚 Historie teilen</button>`;
            showModal('📚 Spiel-Historie', content);
        }

        function shareHistory() {
            if (gameHistory.length === 0) {
                showNotification('📚', 'Noch keine Spiele gespielt!');
                return;
            }
            
            const recentGames = gameHistory.slice(-5);
            const shareText = `🎭 Meine letzten Impostor Spiele:\n\n` +
                recentGames.map(game => 
                    `🎯 ${game.word} (${game.players} Spieler, ${game.duration})`
                ).join('\n') +
                `\n\nSpiele auch mit: party-games.me 🎮`;

            if (navigator.share) {
                navigator.share({
                    title: 'Meine Impostor Spiele',
                    text: shareText
                }).catch(err => {
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }

        function showAchievementsModal() {
            toggleSettingsMenu();
            let content = '<div style="max-height: 300px; overflow-y: auto;">';
            
            Object.keys(ACHIEVEMENTS).forEach(key => {
                const achievement = ACHIEVEMENTS[key];
                const unlocked = achievements[key] || false;
                content += `
                    <div class="achievement-item ${unlocked ? 'unlocked' : ''}">
                        <div style="display: flex; align-items: center;">
                            <span class="achievement-icon">${achievement.icon}</span>
                            <div>
                                <strong style="font-size: 16px;">${achievement.name}</strong><br>
                                <small style="color: #666; font-size: 13px;">${achievement.description}</small>
                            </div>
                        </div>
                        <div style="font-size: 20px;">${unlocked ? '✅' : '❌'}</div>
                    </div>
                `;
            });
            
            content += '</div>';
            content += `<button class="share-button" onclick="shareAchievements()">🏆 Erfolge teilen</button>`;
            showModal('🏆 Erfolge', content);
        }

        function shareAchievements() {
            const unlockedAchievements = Object.keys(ACHIEVEMENTS).filter(key => achievements[key]);
            const totalAchievements = Object.keys(ACHIEVEMENTS).length;
            
            if (unlockedAchievements.length === 0) {
                showNotification('🏆', 'Noch keine Erfolge freigeschaltet!');
                return;
            }
            
            const shareText = `🏆 Meine Impostor Erfolge (${unlockedAchievements.length}/${totalAchievements}):\n\n` +
                unlockedAchievements.map(key => 
                    `${ACHIEVEMENTS[key].icon} ${ACHIEVEMENTS[key].name}`
                ).join('\n') +
                `\n\nSpiele auch mit: party-games.me 🎮`;

            if (navigator.share) {
                navigator.share({
                    title: 'Meine Impostor Erfolge',
                    text: shareText
                }).catch(err => {
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }

        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('📋', 'In Zwischenablage kopiert!');
                }).catch(() => {
                    fallbackCopyTextToClipboard(text);
                });
            } else {
                fallbackCopyTextToClipboard(text);
            }
        }

        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-999999px";
            textArea.style.top = "-999999px";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showNotification('📋', 'In Zwischenablage kopiert!');
            } catch (err) {
                showNotification('❌', 'Kopieren fehlgeschlagen');
            }
            
            document.body.removeChild(textArea);
        }

        function showNotification(icon, message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: rgba(0,0,0,0.9);
                color: white;
                padding: 16px 20px;
                border-radius: 20px;
                font-weight: 600;
                z-index: 10000;
                animation: slideInFromRight 0.5s ease-out;
                max-width: 300px;
                box-shadow: 0 16px 40px rgba(0,0,0,0.3);
                backdrop-filter: blur(10px);
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span style="font-size: 24px;">${icon}</span>
                    <div style="font-size: 14px;">${message}</div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutToRight 0.5s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 500);
            }, 2000);
        }

        // Stats and Achievement Functions
        function checkAchievements() {
            let newAchievements = [];
            
            // First Game
            if (!achievements.firstGame && playerStats.gamesPlayed >= 1) {
                achievements.firstGame = true;
                newAchievements.push(ACHIEVEMENTS.firstGame);
            }
            
            // Veteran - 25 Spiele
            if (!achievements.veteran && playerStats.gamesPlayed >= 25) {
                achievements.veteran = true;
                newAchievements.push(ACHIEVEMENTS.veteran);
            }
            
            // Dedicated - 100 Spiele
            if (!achievements.dedicated && playerStats.gamesPlayed >= 100) {
                achievements.dedicated = true;
                newAchievements.push(ACHIEVEMENTS.dedicated);
            }
            
            // Impostor - 10x Impostor
            if (!achievements.impostor && playerStats.totalImpostorRounds >= 10) {
                achievements.impostor = true;
                newAchievements.push(ACHIEVEMENTS.impostor);
            }
            
            // Speed Runner - unter 30 Sekunden
            if (!achievements.speedRunner && playerStats.fastestGame && parseInt(playerStats.fastestGame) < 30) {
                achievements.speedRunner = true;
                newAchievements.push(ACHIEVEMENTS.speedRunner);
            }
            
            // Marathon - über 10 Minuten (600 Sekunden)
            if (!achievements.marathon && playerStats.longestGame && parseInt(playerStats.longestGame) > 600) {
                achievements.marathon = true;
                newAchievements.push(ACHIEVEMENTS.marathon);
            }
            
            // Social - mit 10+ Personen gespielt
            if (!achievements.social && gameHistory.some(game => game.players >= 10)) {
                achievements.social = true;
                newAchievements.push(ACHIEVEMENTS.social);
            }
            
            // Explorer - alle 3 Kategorien gespielt
            if (!achievements.explorer && getPlayedCategories() === '3/3') {
                achievements.explorer = true;
                newAchievements.push(ACHIEVEMENTS.explorer);
            }
            
            if (newAchievements.length > 0) {
                showAchievementNotification(newAchievements);
            }
        }

        function showAchievementNotification(newAchievements) {
            newAchievements.forEach((achievement, index) => {
                setTimeout(() => {
                    const notification = document.createElement('div');
                    notification.style.cssText = `
                        position: fixed;
                        top: 100px;
                        right: 20px;
                        background: linear-gradient(135deg, #FFD700, #FFA500);
                        color: #333;
                        padding: 16px 20px;
                        border-radius: 20px;
                        font-weight: 600;
                        z-index: 10000;
                        animation: slideInFromRight 0.5s ease-out;
                        max-width: 300px;
                        box-shadow: 0 16px 40px rgba(0,0,0,0.2);
                        backdrop-filter: blur(10px);
                    `;
                    
                    notification.innerHTML = `
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span style="font-size: 28px;">${achievement.icon}</span>
                            <div>
                                <div style="font-size: 16px; font-weight: 700;">Erfolg freigeschaltet!</div>
                                <div style="font-size: 14px; opacity: 0.8;">${achievement.name}</div>
                            </div>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    playSound('success');
                    vibrate([100, 50, 100]);
                    
                    setTimeout(() => {
                        notification.style.animation = 'slideOutToRight 0.5s ease-in';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 500);
                    }, 3000);
                }, index * 500);
            });
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
            
            const settingsIcon = document.getElementById('settingsIcon');
            if (settingsIcon) {
                if (screenId === 'modeSelectScreen') {
                    settingsIcon.style.display = 'flex';
                } else {
                    settingsIcon.style.display = 'none';
                }
            }
        }

        // WIRKLICH SMOOTH TRANSITION
        function showCleanTransition(callback) {
            const transition = document.getElementById('screenTransition');
            
            // Show black overlay - ULTRA SMOOTH
            transition.classList.add('active');
            
            setTimeout(() => {
                // Change to impostor background
                transition.classList.add('impostor');
                
                setTimeout(() => {
                    // Execute callback
                    callback();
                    
                    setTimeout(() => {
                        // Hide overlay - ULTRA SMOOTH
                        transition.classList.remove('active', 'impostor');
                    }, 25); /* SEHR SCHNELL */
                }, 100); /* KURZ */
            }, 75); /* KURZ */
        }

        function handleCardClick(event) {
            const card = event.currentTarget;
            const gameType = card.getAttribute('data-game');
            
            if (gameType === 'impostor') {
                showCleanTransition(() => {
                    showImpostorSettings();
                });
            }
        }

        function showModeSelect() {
            showScreen('modeSelectScreen');
        }

        function showImpostorSettings() {
            showScreen('impostorScreen');
            updateGameSettingsDisplay();
        }

        function showGame() {
            showScreen('gameScreen');
            updateGameDisplay();
        }

        function showGameStarted() {
            showScreen('gameStartedScreen');
            updateGameStartedDisplay();
        }

        function showRoles() {
            showScreen('endScreen');
            displayRoles();
            showConfetti();
            playSound('success');
            vibrate([200, 100, 200]);
        }

        // Scroll to specific card and update indicators
        function scrollToCard(cardIndex) {
            const container = document.getElementById('gamesContainer');
            const gameCard = container.querySelectorAll('.game-card')[cardIndex];
            if (!gameCard) return;
            
            const cardWidth = gameCard.offsetWidth + 20;
            container.scrollTo({
                left: cardIndex * cardWidth,
                behavior: 'smooth'
            });
            
            // Update indicators immediately
            setTimeout(() => {
                updateCardIndicators();
            }, 100);
        }

        // Update card indicators based on scroll position
        function updateCardIndicators() {
            const container = document.getElementById('gamesContainer');
            const cards = container.querySelectorAll('.game-card');
            
            if (cards.length === 0) return;
            
            const containerRect = container.getBoundingClientRect();
            const containerCenter = containerRect.left + containerRect.width / 2;
            
            let activeIndex = 0;
            let minDistance = Infinity;
            
            cards.forEach((card, index) => {
                const cardRect = card.getBoundingClientRect();
                const cardCenter = cardRect.left + cardRect.width / 2;
                const distance = Math.abs(cardCenter - containerCenter);
                
                if (distance < minDistance) {
                    minDistance = distance;
                    activeIndex = index;
                }
            });
            
            // Update indicators
            document.querySelectorAll('.snap-dot').forEach((dot, index) => {
                if (index === activeIndex) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }

        // Settings Functions
        function changePlayerCount(delta) {
            gameState.totalPlayers = Math.max(3, Math.min(20, gameState.totalPlayers + delta));
            if (gameState.impostors >= Math.floor(gameState.totalPlayers / 2)) {
                gameState.impostors = Math.max(1, Math.floor(gameState.totalPlayers / 2) - 1);
            }
            updateGameSettingsDisplay();
            playSound('card-flip');
        }

        function changeImpostorCount(delta) {
            gameState.impostors = Math.max(1, Math.min(Math.floor(gameState.totalPlayers / 2), gameState.impostors + delta));
            updateGameSettingsDisplay();
            playSound('card-flip');
        }

        function toggleTimer() {
            gameState.timerEnabled = !gameState.timerEnabled;
            const toggle = document.getElementById('timerToggle');
            const minutesRow = document.getElementById('timerMinutesRow');
            
            toggle.classList.toggle('active', gameState.timerEnabled);
            minutesRow.style.display = gameState.timerEnabled ? 'flex' : 'none';
            playSound('card-flip');
        }

        function changeTimerMinutes(delta) {
            gameState.timerMinutes = Math.max(1, Math.min(10, gameState.timerMinutes + delta));
            document.getElementById('timerMinutesCount').textContent = gameState.timerMinutes;
            playSound('card-flip');
        }

        function toggleHints() {
            gameState.hintsEnabled = !gameState.hintsEnabled;
            document.getElementById('hintsToggle').classList.toggle('active', gameState.hintsEnabled);
            playSound('card-flip');
        }

        function toggleCategoryDropdown() {
            const dropdown = document.getElementById('categoryDropdown');
            dropdown.classList.toggle('hidden');
        }

        function selectCategory(category) {
            gameState.category = category;
            const categoryNames = {
                'alle': 'Alle',
                'food': 'Essen',
                'animals': 'Tiere', 
                'objects': 'Objekte'
            };
            
            document.getElementById('categoryButton').textContent = (categoryNames[category] || category) + ' ▼';
            document.getElementById('categoryDropdown').classList.add('hidden');
            playSound('card-flip');
        }

        function updateGameSettingsDisplay() {
            document.getElementById('playersCount').textContent = gameState.totalPlayers;
            document.getElementById('impostorsCount').textContent = gameState.impostors;
            document.getElementById('timerMinutesCount').textContent = gameState.timerMinutes;
            
            // Update timer toggle and minutes row visibility
            const timerToggle = document.getElementById('timerToggle');
            const minutesRow = document.getElementById('timerMinutesRow');
            timerToggle.classList.toggle('active', gameState.timerEnabled);
            minutesRow.style.display = gameState.timerEnabled ? 'flex' : 'none';
        }

        // Game Logic
        function generateGame() {
            // Select words based on category
            let selectedWords = [];
            if (gameState.category === 'alle') {
                selectedWords = [...WORD_CATEGORIES.food, ...WORD_CATEGORIES.animals, ...WORD_CATEGORIES.objects];
            } else {
                selectedWords = WORD_CATEGORIES[gameState.category] || WORD_CATEGORIES.food;
            }
            
            const selectedWord = selectedWords[Math.floor(Math.random() * selectedWords.length)];
            gameState.gameWord = selectedWord.word;
            gameState.gameHint = selectedWord.hint;
            
            // Generate impostor assignments
            gameState.impostorPlayers = [];
            while (gameState.impostorPlayers.length < gameState.impostors) {
                const randomPlayer = Math.floor(Math.random() * gameState.totalPlayers) + 1;
                if (!gameState.impostorPlayers.includes(randomPlayer)) {
                    gameState.impostorPlayers.push(randomPlayer);
                }
            }
            
            // Generate player emojis
            gameState.playerEmojis = [];
            const shuffledEmojis = [...coolEmojis].sort(() => Math.random() - 0.5);
            for (let i = 0; i < gameState.totalPlayers; i++) {
                gameState.playerEmojis.push(shuffledEmojis[i] || coolEmojis[Math.floor(Math.random() * coolEmojis.length)]);
            }
        }

        function startGame() {
            generateGame();
            gameState.currentPlayer = 1;
            gameState.gameStartTime = Date.now();
            showScreen('gameScreen');
            updateGameDisplay();
            playSound('shuffle');
            vibrate([50, 50, 50]);
        }

        function updateGameDisplay() {
            document.getElementById('playerTitle').textContent = `Spieler ${gameState.currentPlayer}`;
            document.getElementById('playerEmoji').textContent = gameState.playerEmojis[gameState.currentPlayer - 1] || '👤';
            
            if (gameState.currentPlayer < gameState.totalPlayers) {
                document.getElementById('nextButton').textContent = 'Weitergeben';
            } else {
                document.getElementById('nextButton').textContent = 'Spiel starten';
            }
            
            hideRole();
        }

        function showRole() {
            const isImpostor = gameState.impostorPlayers.includes(gameState.currentPlayer);
            const roleIcon = document.getElementById('roleIcon');
            const roleText = document.getElementById('roleText');
            const wordOrHint = document.getElementById('wordOrHint');
            
            if (isImpostor) {
                roleIcon.textContent = '✕';
                roleIcon.className = 'role-icon impostor';
                roleText.textContent = 'Du bist Impostor!';
                if (gameState.hintsEnabled) {
                    wordOrHint.innerHTML = `<div class="hint-display">Tipp: ${gameState.gameHint}</div>`;
                } else {
                    wordOrHint.innerHTML = '';
                }
            } else {
                roleIcon.textContent = '✓';
                roleIcon.className = 'role-icon normal';
                roleText.textContent = '';
                wordOrHint.innerHTML = `<div class="word-display">${gameState.gameWord}</div>`;
            }
            
            document.getElementById('revealedContent').classList.add('visible');
            document.getElementById('playerCard').classList.add('lifted');
            vibrate([30]);
        }

        function hideRole() {
            document.getElementById('revealedContent').classList.remove('visible');
            document.getElementById('playerCard').classList.remove('lifted');
        }

        function handleNextPlayer() {
            const nextButton = document.getElementById('nextButton');
            
            if (gameState.currentPlayer < gameState.totalPlayers) {
                nextButton.style.transform = 'scale(0.96)';
                setTimeout(() => {
                    nextButton.style.transform = 'scale(1)';
                }, 150);
                
                const playerCard = document.getElementById('playerCard');
                playerCard.classList.add('flipping');
                playSound('card-flip');
                vibrate([50]);
                
                setTimeout(() => {
                    gameState.currentPlayer++;
                    updateGameDisplay();
                    playerCard.classList.remove('flipping');
                }, 600);
                
            } else {
                nextButton.style.transform = 'scale(0.96)';
                nextButton.textContent = 'Spiel startet...';
                
                setTimeout(() => {
                    nextButton.style.transform = 'scale(1)';
                    gameState.startingPlayer = Math.floor(Math.random() * gameState.totalPlayers) + 1;
                    showGameStarted();
                    nextButton.textContent = 'Spiel starten';
                    playSound('success');
                    vibrate([100, 50, 100]);
                }, 800);
            }
        }

        function updateGameStartedDisplay() {
            const starterText = document.getElementById('starterText');
            starterText.textContent = `Spieler ${gameState.startingPlayer} beginnt`;
            starterText.classList.remove('shrunk');
            
            // Show timer if enabled
            if (gameState.timerEnabled) {
                gameState.timeLeft = gameState.timerMinutes * 60;
                document.getElementById('timerDisplay').classList.remove('hidden');
                startTimer();
            } else {
                document.getElementById('timerDisplay').classList.add('hidden');
            }
            
            // Shrink text after 5 seconds
            setTimeout(() => {
                starterText.classList.add('shrunk');
            }, 5000);
        }

        function startTimer() {
            if (gameState.timer) {
                clearInterval(gameState.timer);
            }
            
            updateTimerDisplay();
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                updateTimerDisplay();
                
                // Warning vibrations at 10 seconds
                if (gameState.timeLeft === 10) {
                    vibrate([200, 200, 200]);
                }
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timer);
                    gameState.timer = null;
                    vibrate([500, 200, 500]);
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            const display = document.getElementById('timerDisplay');
            display.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Change color when time is running out
            if (gameState.timeLeft <= 30) {
                display.style.background = 'rgba(244, 67, 54, 0.8)';
            } else if (gameState.timeLeft <= 60) {
                display.style.background = 'rgba(255, 193, 7, 0.8)';
            }
        }

        function displayRoles() {
            const rolesList = document.getElementById('rolesList');
            rolesList.innerHTML = '';
            
            // Calculate game duration
            gameState.roundDuration = Math.round((Date.now() - gameState.gameStartTime) / 1000);
            
            // Update stats
            playerStats.gamesPlayed++;
            playerStats.totalPlayTime += gameState.roundDuration;
            
            // Check if current player was impostor (assuming player 1 is the user)
            const wasImpostor = gameState.impostorPlayers.includes(1);
            if (wasImpostor) {
                playerStats.totalImpostorRounds++;
            }
            
            // Update fastest and longest game
            if (!playerStats.fastestGame || gameState.roundDuration < parseInt(playerStats.fastestGame)) {
                playerStats.fastestGame = gameState.roundDuration + 's';
            }
            if (!playerStats.longestGame || gameState.roundDuration > parseInt(playerStats.longestGame)) {
                playerStats.longestGame = gameState.roundDuration + 's';
            }
            
            // Add to history without impostor info
            gameHistory.push({
                date: Date.now(),
                word: gameState.gameWord,
                players: gameState.totalPlayers,
                duration: gameState.roundDuration + 's'
            });
            
            // Keep only last 50 games
            if (gameHistory.length > 50) {
                gameHistory.shift();
            }
            
            checkAchievements();
            
            for (let i = 1; i <= gameState.totalPlayers; i++) {
                const isImpostor = gameState.impostorPlayers.includes(i);
                const playerEmoji = gameState.playerEmojis[i-1] || '👤';
                
                const roleItem = document.createElement('div');
                roleItem.className = 'role-item';
                
                const rolePlayer = document.createElement('div');
                rolePlayer.className = 'role-player';
                
                const roleIcon = document.createElement('div');
                roleIcon.style.cssText = `width: 32px; height: 32px; font-size: 16px; margin-right: 14px; display: flex; align-items: center; justify-content: center; border-radius: 50%; background: ${isImpostor ? '#f44336' : '#4CAF50'}; color: white; font-weight: bold;`;
                roleIcon.textContent = isImpostor ? '✕' : '✓';
                
                const playerText = document.createElement('span');
                playerText.textContent = `${playerEmoji} Spieler ${i}`;
                
                rolePlayer.appendChild(roleIcon);
                rolePlayer.appendChild(playerText);
                
                const roleResult = document.createElement('div');
                roleResult.className = 'role-result';
                
                if (isImpostor) {
                    roleResult.innerHTML = `<strong>Impostor</strong>` + 
                        (gameState.hintsEnabled && gameState.gameHint ? `<br><small>Tipp: ${gameState.gameHint}</small>` : '');
                } else {
                    roleResult.innerHTML = `<strong>${gameState.gameWord}</strong>`;
                }
                
                roleItem.appendChild(rolePlayer);
                roleItem.appendChild(roleResult);
                rolesList.appendChild(roleItem);
            }
        }

        // Event Listeners
        document.addEventListener('keydown', function(event) {
            if (document.getElementById('gameScreen').classList.contains('hidden')) return;
            if (event.code === 'Space' || event.key === ' ') {
                event.preventDefault();
                showRole();
            }
        });

        document.addEventListener('keyup', function(event) {
            if (document.getElementById('gameScreen').classList.contains('hidden')) return;
            if (event.code === 'Space' || event.key === ' ') {
                event.preventDefault();
                hideRole();
            }
        });

        document.addEventListener('click', function(event) {
            if (!event.target.closest('.dropdown') && !event.target.closest('.settings-menu') && !event.target.closest('.settings-icon')) {
                const dropdown = document.getElementById('categoryDropdown');
                const settingsMenu = document.getElementById('settingsMenu');
                if (dropdown) dropdown.classList.add('hidden');
                if (settingsMenu) settingsMenu.classList.remove('visible');
            }
        });

        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        // Initialize with scroll listener for indicators
        function initialize() {
            updateGameSettingsDisplay();
            updateSettingsDisplay();
            
            // Add scroll listener for card indicators
            const gamesContainer = document.getElementById('gamesContainer');
            if (gamesContainer) {
                gamesContainer.addEventListener('scroll', updateCardIndicators);
                // Initial indicator update
                setTimeout(updateCardIndicators, 100);
            }
            
            // Apply saved theme
            if (settings.lightTheme) {
                document.body.classList.add('light-theme');
            }
            
            showModeSelect();
        }

        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }
    </script>
</body>
</html>
